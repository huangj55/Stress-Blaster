<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>压力怪兽 - 释放你的压力</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🎮</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.0.0/dist/tf.min.js"></script>
    <!-- FaceMesh -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/facemesh@0.0.3"></script>
    <!-- MediaPipe Hands -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1646424915/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils@0.3/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils@0.3/drawing_utils.js" crossorigin="anonymous"></script>
    <!-- 其他依赖 -->
    <script src="https://unpkg.com/ml5@0.12.2/dist/ml5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
    <script src="https://console.faceplusplus.com/static/js/facepp-sdk.min.js"></script>
    <!-- 主脚本 -->
    <script src="script.js" defer></script>
</head>
<body>
    <!-- 开场视频 -->
    <div id="openingVideo" class="opening-video">
        <div id="startButton" class="start-experience-btn">
            <button class="cartoon-btn" onclick="startExperience()">开始体验</button>
        </div>
        <video id="coversheetVideo" playsinline preload="auto">
            <source src="images/coversheet.mp4" type="video/mp4">
            您的浏览器不支持视频播放。
        </video>
        <div class="click-to-continue">点击播放</div>
    </div>

    <!-- 视频背景 -->
    <div class="video-background">
        <video id="backgroundVideo" autoplay muted loop playsinline preload="auto">
            <source src="images/in.mp4" type="video/mp4">
        </video>
    </div>
    <!-- 引入视频和相关容器 -->
    <div id="intro" class="page">
        <video id="intro-video" autoplay muted>
            <source src="images/coversheet.mp4" type="video/mp4">
            您的浏览器不支持视频标签。
        </video>
        <div id="overlay" style="display: none;"></div>
        <div id="typing-container" class="retro-text" style="display: none;"></div>
        <button id="next-page" class="retro-btn" style="display: none;">下一页</button>
    </div>
    <!-- 添加装饰元素 -->
    <div class="pixel-border-top"></div>
    <div class="grass-container"></div>
    <div class="mushroom" style="top: 20px; left: 20px;"></div>
    <div class="mushroom" style="top: 20px; right: 20px;"></div>
    <div class="star" style="bottom: 20px; left: 20px;"></div>
    <div class="star" style="bottom: 20px; right: 20px;"></div>

    <div id="page1" class="page">
        <h1 class="cartoon-title">焦虑清零器</h1>
        <p class="cartoon-text">说出你的焦虑，我帮你打败它！</p>
        <button class="cartoon-btn" onclick="showTransitionTip()">开始释放</button>
    </div>
    <div id="transitionTip" class="page transition-tip-page">
        <div class="transition-tip-container">
            <div class="pixel-sparkle">✨</div>
            <h2 class="transition-title">说出你的烦恼吧</h2>
            <div class="transition-content">
                <p class="transition-text">我们会将你的焦虑变成一只"情绪怪兽"</p>
                <p class="transition-text">你只需要输入一句让你不安的话，就可以开始这场"打怪减压"之旅！</p>
            </div>
            <button class="cartoon-btn transition-continue-btn" onclick="showPage(2)">继续</button>
        </div>
    </div>
    <div id="page2" class="page">
        <h2 class="cartoon-title">说出你的焦虑</h2>
        <textarea id="anxietyInput" rows="4" placeholder="例如：我总是担心朋友不喜欢我..." class="cartoon-textarea"></textarea>
        <div class="button-group">
            <button class="cartoon-btn" onclick="startVoiceInput()">语音输入</button>
            <button class="cartoon-btn" onclick="submitAnxiety()">提交</button>
        </div>
    </div>
    <div id="page3" class="page">
        <h2 id="monsterName" class="cartoon-title">焦虑怪物</h2>
        <div id="monster" class="cartoon-monster">
            <video id="monsterVideo" width="160" height="160" autoplay loop muted playsinline crossorigin="anonymous"></video>
        </div>
        <div id="hp" class="cartoon-hp">
            <div id="hpFill" class="cartoon-hp-fill"></div>
        </div>
        <div style="position: relative; display: inline-block;">
            <video id="video" width="320" height="240" autoplay playsinline></video>
            <canvas id="handCanvas" width="320" height="240" style="position: absolute; top: 0; left: 0; pointer-events: none;"></canvas>
        </div>
        <p class="cartoon-text">尝试微笑或挥手攻击怪物！</p>
        <div class="battle-controls">
            <select id="weaponSelect" class="cartoon-select">
                <option value="wave">挥手攻击</option>
                <option value="smile">微笑攻击</option>
                <option value="click">鼠标点击</option>
            </select>
            <button class="cartoon-btn" onclick="manualAttack()">手动攻击</button>
        </div>
    </div>
    <div id="page4" class="page">
        <div class="victory-container">
            <h2 class="cartoon-title">胜利！</h2>
            <p id="encouragement" class="cartoon-text"></p>
            <canvas id="recoveryCard" width="400" height="300" class="cartoon-card"></canvas>
            <div class="victory-buttons">
                <button onclick="downloadCard()" class="cartoon-btn">下载恢复卡</button>
                <button onclick="restartGame()" class="cartoon-btn">再来一次</button>
            </div>
        </div>
    </div>
    <div id="page5" class="page">
        <div class="summary-container">
            <h2 class="cartoon-title">关于焦虑</h2>
            <div id="typingText" class="cartoon-text"></div>
            <div class="summary-buttons">
                <button onclick="restartGame()" class="cartoon-btn">重新开始</button>
            </div>
        </div>
    </div>
</body>
</html> 